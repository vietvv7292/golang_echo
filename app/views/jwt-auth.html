{{ template "header.html" . }}

  <h1 class="text-3xl font-bold text-green-700 mb-4">üîê X√°c th·ª±c ng∆∞·ªùi d√πng v·ªõi JWT trong Golang + Echo</h1>

  <p class="text-gray-700 mb-6">Trong t√†i li·ªáu n√†y, b·∫°n s·∫Ω h·ªçc c√°ch t·∫°o Middleware x√°c th·ª±c JWT, t·∫°o route c·∫ßn x√°c th·ª±c, v√† qu·∫£n l√Ω phi√™n ng∆∞·ªùi d√πng m·ªôt c√°ch an to√†n trong ·ª©ng d·ª•ng Golang s·ª≠ d·ª•ng Echo Framework.</p>

  <hr class="my-6">

  <h2 class="text-2xl font-semibold text-gray-800 mb-4">1Ô∏è‚É£ C√†i ƒë·∫∑t th∆∞ vi·ªán JWT</h2>
  <p class="mb-3">Ch√∫ng ta s·∫Ω d√πng th∆∞ vi·ªán <code>github.com/golang-jwt/jwt/v5</code>:</p>
  <pre class="bg-gray-100 p-4 rounded-md overflow-x-auto text-sm"><code>go get github.com/golang-jwt/jwt/v5</code></pre>

  <hr class="my-6">

  <h2 class="text-2xl font-semibold text-gray-800 mb-4">2Ô∏è‚É£ T·∫°o h√†m generate JWT</h2>
  <p class="mb-3">V√≠ d·ª• t·∫°o token khi user ƒëƒÉng nh·∫≠p th√†nh c√¥ng:</p>
  <pre class="bg-gray-100 p-4 rounded-md overflow-x-auto text-sm"><code>import (
    "time"
    "github.com/golang-jwt/jwt/v5"
)

var jwtSecret = []byte("your-secret-key")

func GenerateJWT(userID uint) (string, error) {
    claims := jwt.MapClaims{
        "user_id": userID,
        "exp":     time.Now().Add(time.Hour * 24).Unix(),
    }
    token := jwt.NewWithClaims(jwt.SigningMethodHS256, claims)
    return token.SignedString(jwtSecret)
}</code></pre>

  <hr class="my-6">

  <h2 class="text-2xl font-semibold text-gray-800 mb-4">3Ô∏è‚É£ Middleware x√°c th·ª±c JWT</h2>
  <p class="mb-3">Middleware ƒë·ªÉ x√°c minh token v√† g√°n user v√†o context:</p>
  <pre class="bg-gray-100 p-4 rounded-md overflow-x-auto text-sm"><code>func JWTMiddleware(next echo.HandlerFunc) echo.HandlerFunc {
    return func(c echo.Context) error {
        authHeader := c.Request().Header.Get("Authorization")
        if authHeader == "" {
            return echo.NewHTTPError(http.StatusUnauthorized, "Missing token")
        }

        tokenStr := strings.TrimPrefix(authHeader, "Bearer ")
        token, err := jwt.Parse(tokenStr, func(token *jwt.Token) (interface{}, error) {
            if _, ok := token.Method.(*jwt.SigningMethodHMAC); !ok {
                return nil, fmt.Errorf("Unexpected signing method")
            }
            return jwtSecret, nil
        })

        if err != nil || !token.Valid {
            return echo.NewHTTPError(http.StatusUnauthorized, "Invalid token")
        }

        claims := token.Claims.(jwt.MapClaims)
        c.Set("user_id", claims["user_id"])

        return next(c)
    }
}</code></pre>

  <hr class="my-6">

  <h2 class="text-2xl font-semibold text-gray-800 mb-4">4Ô∏è‚É£ ƒê·ªãnh nghƒ©a route c·∫ßn x√°c th·ª±c</h2>
  <p class="mb-3">G·∫Øn middleware cho route y√™u c·∫ßu login:</p>
  <pre class="bg-gray-100 p-4 rounded-md overflow-x-auto text-sm"><code>func main() {
    e := echo.New()

    e.POST("/login", LoginHandler) // Tr·∫£ v·ªÅ JWT

    r := e.Group("/api")
    r.Use(JWTMiddleware)
    r.GET("/profile", GetProfile)

    e.Logger.Fatal(e.Start(":8080"))
}</code></pre>

  <hr class="my-6">

  <h2 class="text-2xl font-semibold text-gray-800 mb-4">5Ô∏è‚É£ Handler tr·∫£ v·ªÅ th√¥ng tin ng∆∞·ªùi d√πng</h2>
  <pre class="bg-gray-100 p-4 rounded-md overflow-x-auto text-sm"><code>func GetProfile(c echo.Context) error {
    userID := c.Get("user_id")
    return c.JSON(http.StatusOK, map[string]interface{}{
        "message": "ƒê√£ x√°c th·ª±c JWT",
        "user_id": userID,
    })
}</code></pre>

  <hr class="my-6">

  <h2 class="text-2xl font-semibold text-gray-800 mb-4">‚úÖ T·ªïng k·∫øt</h2>
  <ul class="list-disc list-inside text-gray-700">
    <li>JWT n√™n ƒë∆∞·ª£c truy·ªÅn qua header <code>Authorization: Bearer &lt;token&gt;</code></li>
    <li>Token ch·ª©a th√¥ng tin ng∆∞·ªùi d√πng v√† th·ªùi h·∫°n</li>
    <li>Middleware s·∫Ω x√°c th·ª±c v√† gi·∫£i m√£ token</li>
    <li>Handler c√≥ th·ªÉ l·∫•y user ID t·ª´ context</li>
  </ul>

  <p class="mt-4 text-gray-600">B·∫°n c√≥ th·ªÉ m·ªü r·ªông b·∫±ng c√°ch l·∫•y user t·ª´ DB d·ª±a v√†o <code>user_id</code> trong token.</p>

{{ template "footer.html" . }}
